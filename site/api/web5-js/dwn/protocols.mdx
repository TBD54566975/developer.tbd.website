import Divider from '@site/src/components/Divider';
import ApiDetails from '@site/src/components/ApiDetails';
import CodeSnippet from '@site/src/components/CodeSnippet';

# protocols

## Overview
The `protocols` class is responsible for providing convenience methods for managing protocols between DWNs. [Learn more about Protocols](/docs/web5/learn/protocols).

<Divider type="slash"/>

<section class="api-docs">

## Methods

<br/>

### configure(request)

Configures a protocol definition in the user's local DWN, remote DWN, or another party's DWN (if permitted). Fields under the `structure` object of the Protocol definition are expected to be one of the type references matching those defined in the `types` object. The type structures are recursive, so types form a graph and each type can have within it further attached types or rule statements that are all denoted with the prefix $.

#### Parameters

<ApiDetails
  details={[
    {
      data: {
        isObject: true,
        type: 'ProtocolsConfigureRequest',
        field: 'request',
        value: <ApiDetails
                details={[
                {
                  data: {
                    isObject: true,
                    type: 'ProtocolsConfigureOptions',
                    field: 'message',
                    value: <ApiDetails
                            details={[
                            {
                                data: {
                                    isObject: true,
                                    type: 'ProtocolDefinition',
                                    field: 'definition',
                                    value: <ApiDetails
                                            details={[
                                            {
                                                data: {
                                                    type: 'string',
                                                    field: 'protocol',
                                                    value: 'URI that represents the protocol being configured',
                                                },
                                            },
                                            {
                                                data: {
                                                    type: 'boolean',
                                                    field: 'published',
                                                    value: 'Indicates whether the protocol should be public',
                                                },
                                            },
                                            {
                                                data: {
                                                    isObject: true,
                                                    type: 'ProtocolTypes',
                                                    field: 'types',
                                                    value: <ApiDetails
                                                            details={[
                                                            {
                                                                data: {
                                                                    isOptional: true,
                                                                    type: 'string',
                                                                    field: 'schema',
                                                                    value: 'URI of the schema under which the records will be bucketed',
                                                                },
                                                            },
                                                            {
                                                                data: {
                                                                    isOptional: true,
                                                                    type: 'string[]',
                                                                    field: 'dataFormats',
                                                                    value: 'Array of the IANA strings corresponding with the formats of how the data will be bucketed. See IANA\'s Media Type list here: https://www.iana.org/assignments/media-types/media-types.xhtml',
                                                                },
                                                            },
                                                        ]}
                                                      />,
                                                },
                                            },
                                            {
                                                data: {
                                                    isObject: true,
                                                    type: 'ProtocolRuleSet',
                                                    field: 'structure',
                                                    value: <ApiDetails
                                                            details={[
                                                            {
                                                                data: {
                                                                    isObject: true,
                                                                    type: 'ProtocolActionRule[]',
                                                                    field: '$actions',
                                                                    value: <ApiDetails
                                                                            details={[
                                                                            {
                                                                              data: {
                                                                                type: 'string',
                                                                                field: 'who',
                                                                                value: 'The actor that is being permitted to invoke a given action. Valid values are: \'anyone\' | \'author\' | \'recipient\'',
                                                                              },
                                                                            },
                                                                            {
                                                                              data: {
                                                                                isOptional: true,
                                                                                type: 'string',
                                                                                field: 'of',
                                                                                value: 'The protocol path. Must be present if the actor is \'author\' or \'recipient\'. Must be absent if the actor is \'anyone\'',
                                                                              },
                                                                            },
                                                                            {
                                                                              data: {
                                                                                type: 'string',
                                                                                field: 'can',
                                                                                value: 'The action that the actor can perform. May be \'read\' | \'write\'',
                                                                              }
                                                                            },
                                                                        ]}
                                                                      />,
                                                                },
                                                            },
                                                        ]}
                                                      />,
                                                },
                                            },
                                        ]}
                                      />,
                                },
                            },
                        ]}
                      />,
                  },
                },
              ]}
          />
      },
    },
  ]}
/>


#### Return Value

<ApiDetails
  details={[
    {
      data: {
        field: 'ProtocolsConfigureResponse',
        value: 'A response object containing the status of the request and a Protocol object if successful',
      },
    },
  ]}
/>



#### Code Example

<CodeSnippet functionName="configureProtocolWithDefinition" />




<Divider type="slash"/>

### query(request)

Queries a DID's DWNs for the presence of a protocol. This method is useful in detecting what protocols a given DID has installed to enable interaction over the protocol. See [query from DWN guide](/docs/web5/build/decentralized-web-nodes/query-from-dwn) for more details.

#### Parameters

<ApiDetails
  details={[
    {
      data: {
        isObject: true,
        type: 'ProtocolsQueryRequest',
        field: 'request',
        value: <ApiDetails
                details={[
                {
                    data: {
                        isOptional: true,
                        type: 'string',
                        field: 'from',
                        value: 'The DID of the DWN to query',
                    },
                },
                {
                    data: {
                        isObject: true,
                        type: 'ProtocolsQueryOptions',
                        field: 'message',
                        value: <ApiDetails
                                details={[
                                {
                                    data: {
                                        isOptional: true,
                                        type: 'string',
                                        field: 'dateCreated',
                                        value: 'Date of creation for the protocols to query',
                                    }
                                },
                                {
                                    data: {
                                        isObject: true,
                                        isOptional: true,
                                        type: 'ProtocolsQueryFilter',
                                        field: 'filter',
                                        value: <ApiDetails
                                                details={[
                                                {
                                                    data: {
                                                        type: 'string',
                                                        isOptional: true,
                                                        field: 'protocol',
                                                        value: 'URI of the protocol bucket in which to query',
                                                    },
                                                },
                                            ]}
                                        />,
                                    },
                                },
                            ]}
                        />,
                    },
                },
            ]}
          />,
      },
    },
  ]}
/>


#### Return Value

<ApiDetails
  details={[
    {
      data: {
        field: 'ProtocolsQueryResponse',
        value: 'A response object containing the status of the request and an array of matching Protocol objects',
      },
    },
  ]}
/>


#### Code Examples

<CodeSnippet functionName="queryMusicProtocol" />

<CodeSnippet functionName="queryProtocolsFromDid" />

<CodeSnippet functionName="queryProtocolDescending" />
</section>
