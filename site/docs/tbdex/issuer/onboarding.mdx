# Onboarding

Although you may know you want to build a service to issue Verifiable Credentails (VCs) to faciliate trust and transactions through tbDEX, you may be looking for more background knowledge before beginning development. Our [overview guide on VCs](/docs/web5/learn/verifiable-credentials) serves as background on the overall topic of issuance and VCs.

Additionally, developing an Issuer app will require use of our `@web5/credentials` package via `npm`, which we'll cover in more specifics later.

## Overview

A Credential Issuer app runs as an API service that exposes endpoints where third parties can request credentials. 

If you already have an Issuer app up and running,  check out the guide on [how to issue credentials with Web5](/docs/web5/build/verifiable-credentials/vc-issuance/).

If you need to create a Credential Issuer app from scratch, continue on with this guide where we'll cover how to: 

- Create a web server using a technology like ** [Express](https://expressjs.com/) ** that will serve as an API endpoint.
- Design the credential you'd like to offer.
- Implement an issuance path where you'll accept a request for issuance, perform any necessary checks, and issue the credential.
- Return the credential to the requester.

## Environment Setup

To set up the VC issuance service, we'll use Express. Follow these instructions to [install Express](https://expressjs.com/en/starter/installing.html). 

You'll also need to install `@web5/credentials` to create and issue credentials:

```bash
npm i @web5/credentials
```

Within your service's entry point file (e.g. main.js), import the following:

```js title=main.js
import { VerifiableCredential } from "@web5/credentials";
import { api } from './api.js'
```

Additionally, to issue credentials, you're required to have a [Decentralized Identifier (DID)](/docs/web5/learn/decentralized-identifiers) which will serve as your Issuer's identity. If you do not already have one, you'll need to [create a DID](/docs/web5/build/decentralized-identifiers/how-to-create-did#create-a-did-manually). 

To start up your Express API service, add the following to a `main.js` file:

```js title=main.js
import { api } from './api.js'

const server = api.listen(config.port, () => {
  log.info(`Server listening on port ${config.port}`)
})

api.get('/credential', async (req, res) => {
    // Implement the /credential API route
 });
```

With this basic structure in place, you'll be ready to now design your credential and implement your issuance path. 

:::note
If you'd like to view a full, runnable project that implements this, see our [VC Issuer Example](https://github.com/TBD54566975/super-simple-sanctions).
:::

## Design the Credential

With your app set up to accept incoming routes, you can then design a model file to represent the specific type of credential you'd like to issue. 

Let's design a VC that attests that a person isn't on a Sanctions list. You could model that class as follows:

```js title=SanctionsCredential.js
import { VerifiableCredential } from "@web5/credentials";

class SanctionsCredential {
  constructor(listsChecked) {
    // indicates the sanctions lists checked against
    this.listsChecked = listsChecked; 
  }
}
```

In the example above, you provide a class property that stores all the sanctions lists checked against to issue the credential. You have wide flexibility with what you can store in the credential model class, which means that you're free to include any public attributes that may be relevant to the credential you are issuing.

Your credential is ** not ** the place to store private information about the user you are issuing the credential to, such as banking information or other PII. Do not include PII in your credential and by extension your credential's model.

## Implement Issuance

With your web server structure in place and credential designed, you're now ready to build out your issuance codepath. This is the code you'll execute when a user requests to be issued a VC.

In that code, you'll want to perform any checks required for you to issue them their credential which will later be verified by an interested 3rd party. In the example below, we'll assume that any user that makes the API request with a valid JWT token is who they say they are, and that the `verifyUserData()` method will then use the identity represented by the JWT token to check this individual against known sanctions lists.

```js title=main.js
api.get('/credential', async (req, res) => {
    try {
        // Intake user data or send back any responses/redirects requesting more info
        const authHeader = req.headers['authorization'];

        if (!authHeader) {
            return res.status(401).json({ errors: ['Authorization header required'] });
        }

        const [_, compactJwt] = authHeader.split('Bearer ');
        const { signer, payload } = await JwtVerifier.verify(compactJwt);

        // Process & verify user data
        const listsChecked = verifyUserData(payload);

        if (listsChecked == null) {
            return res.status(401).json({
                errors: "User failed sanctions Check."
            })
        }

        // Create the credential
        const vc = await VerifiableCredential.create({
            type: "SanctionsCredential",
            issuer: issuerDid.did,
            subject: signer,
            data: new SanctionsCredential(listsChecked)
        });
    }
 });
```

The `vc` object that's returned will be a raw VC that looks like this:

```json
vcDataModel: {
  "@context": [ "https://www.w3.org/2018/credentials/v1" ],
  type: [ "VerifiableCredential", "SanctionsCredential" ],
  id: "urn:uuid:daa5ff01-9b7d-485b-9410-22a42952d46c",
  issuer: "did:key:z6Mkn4w6nSaWe4fjNJRvaHZwFnMm5VexvjzDeozEu2G7jC34",
  issuanceDate: "2023-12-14T08:20:41Z",
  credentialSubject: {
    id: "did:key:z6MkjGSeekPGE9QfczHWyW8v2ZzJU68kqSHzV7L2dmQyuyDu",
    listsChecked: "FBI's Most Wanted, USA Watchlist, EU Watchlist"
  }
}
```

To complete the issuance, you must sign the credential. Signing will return a [VC JSON Web Token](/docs/web5/build/verifiable-credentials/jwt-to-vc#what-is-a-jwt), which is ideal for secure transmission of the credential:

```js title=main.js
const signedVC = await vc.sign({did: issuerDid});
return res.status(201).json({ credential: signedVC });
```

With that, you've implmented a basic credential issuance service to accept requests and issue VCs.




