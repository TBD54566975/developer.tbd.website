---
sidebar_position: 2
title: 'Quickstart: PFI'
hide_title: true
hide_table_of_contents: false
---

import { QuickstartExecutionProvider } from '@site/src/components/QuickstartExecutionContext';
import Version from '@site/src/components/Version';
import PackageJson from '@site/src/components/PackageJson';
import CodeSnippet from '@site/src/components/CodeSnippet';
import PfiQuickstartCodeRunner from '@site/src/components/PfiQuickstartCodeRunner';

<QuickstartExecutionProvider>

# tbDEX PFI in 5️⃣ Minutes

## Overview

A Participating Financial Institution (PFI) in the tbDEX ecosystem provides liquidity offerings to customers via Wallets. Customers can place orders and execute transactions if they meet the necessary requirements.

In this quickstart, you'll:

- Set up a basic PFI with offerings
- Open endpoints for tbDEX-enabled Wallets
- Process Requests for Quote and respond with Quotes
- Handle Orders, provide OrderStatus updates, and close out Orders

Let's get started!

## Building a Simple PFI

### Create a DID

PFIs on tbDEX are identified using [Decentralized Identifiers (DIDs)](/docs/web5/learn/decentralized-identifiers). Let's create a DID for your PFI and specify a service endpoint for wallet applications to interact with your PFI:

<CodeSnippet snippetName="pfiOverviewCreateDid" />
<PfiQuickstartCodeRunner executeCodeName="executeDidCreate" stepIndex={0} customPlaceholder={"See PFI DID"} />

### Structure Your PFI App

PFIs are essentially `node express` servers with `tbDEX` SDK enhancements. You'll need a server and a database (e.g a `postgres` database with `offerings` and `exchanges` tables).

There are two primary components to a PFI: the `OfferingsApi` and the `ExchangesApi`. The `OfferingsApi` allows Wallets to query your PFI for available offerings, while the `ExchangesApi` handles RFQs, Orders, and exchange closures.

#### Extend the `OfferingsApi` and `ExchangesApi` Interfaces
If you have a custom database setup, you can extend the `OfferingsApi` and `ExchangesApi` interfaces with custom instructions to manage the database containing your offerings and exchanges.

#### Create your server instance of `TbdexHttpServer`
Create your main server entry point in `main.ts`, with an instance of `TbdexHttpServer` passing the `exchangesApi`, `offeringsApi` and the `pfiDid`.

<CodeSnippet snippetName="pfiOverviewConfigJs" title="main.ts" />

First, we implement the `ExchangesApiProvider` class by focusing on the `write` function to handle exchange data:

<CodeSnippet snippetName="pfiOverviewWriteJs" title="exchangesApiProvider.ts" />

Next we need to configure the PFI to know how to react when it receives specific types of messages from the customer. To be able to create quotes, handle orders and close out the exchange using the `write` method.

<CodeSnippet snippetName="pfiOverviewServerRoutesJs" title="main.ts" />
{/* <PfiQuickstartCodeRunner executeCodeName="executePingServer" stepIndex={1} customPlaceholder={"Ping the PFI"} /> */}



## Building Out Offerings

Without Offerings, your PFI can't operate. Create an `Offering` object to swap `USD` for `KES` and insert it into your `offerings` table:

<PfiQuickstartCodeRunner executeCodeName="executeAddOffering" stepIndex={1} customPlaceholder={"Add the Offering to the database"} viewJsonObj={true} collapseLevel={3} />

### Fetching Offerings for Wallets

Allow Wallets to query your PFI for Offerings by implementing the `OfferingsApi` interface:

<CodeSnippet snippetName="pfiOverviewReadOfferingsJs" title="offeringsApiProvider.ts" />
<PfiQuickstartCodeRunner executeCodeName="executeGetOfferings" stepIndex={2} customPlaceholder={"Ping the /offerings API Endpoint"} viewJsonObj={true} collapseLevel={3} />

## Processing tbDEX Messages

### Processing RFQs and Returning Quotes

Verify user credentials and generate a `Quote`:

<CodeSnippet snippetName="pfiCreateQuoteJs" title="exchangeApiProvider.ts" />
<PfiQuickstartCodeRunner executeCodeName="executeGetQuote" stepIndex={5} customPlaceholder={"See the Quote"} viewJsonObj={true} collapseLevel={1} />

### Receiving Orders and Returning OrderStatus

Process accepted Quotes, manage Orders, and send `OrderStatus` updates:

<CodeSnippet snippetName="pfiOrderStatusJs" title="exchangeApiProvider.ts" />
<PfiQuickstartCodeRunner executeCodeName="executeGetOrderStatus" stepIndex={6} customPlaceholder={"See the OrderStatus"} viewJsonObj={true} collapseLevel={1} />

### Closing Out Orders

Fulfill and close orders with a `Close` message:

<CodeSnippet snippetName="pfiCloseOrderJs" title="exchangeApiProvider.ts" />
<PfiQuickstartCodeRunner executeCodeName="executeGetClose" stepIndex={7} customPlaceholder={"See the Close Message"} viewJsonObj={true} collapseLevel={1} />

## Next Steps with tbDEX

Congratulations on building your first PFI! To explore further, check out the full [PFI guide](/docs/tbdex/pfi/overview) or learn about [building a Wallet](/docs/tbdex/wallet/overview) and [becoming a Credential Issuer](/docs/tbdex/issuer/overview).


</QuickstartExecutionProvider>
