---
title: Sending RFQs
hide_title: true
sidebar_position: 7
---

import skeletonRfqMessageJS from '!!raw-loader!@site/snippets/testsuite-javascript/__tests__/tbdex/wallet/skeletonRfqMessageJS.snippet.js'
import rfqMetadataJS from '!!raw-loader!@site/snippets/testsuite-javascript/__tests__/tbdex/wallet/rfqMetadataJS.snippet.js'
import createRfqMessageJS from '!!raw-loader!@site/snippets/testsuite-javascript/__tests__/tbdex/wallet/createRfqMessageJS.snippet.js'
import signRfqMessageJS from '!!raw-loader!@site/snippets/testsuite-javascript/__tests__/tbdex/wallet/signRfqMessageJS.snippet.js'
import sendRfqMessageJS from '!!raw-loader!@site/snippets/testsuite-javascript/__tests__/tbdex/wallet/sendRfqMessageJS.snippet.js'
import skeletonRfqMessageKt from '!!raw-loader!@site/snippets/testsuite-kotlin/src/test/kotlin/docs/tbdex/wallet/skeletonRfqMessageKt.snippet.kt'
import rfqMetadataKt from '!!raw-loader!@site/snippets/testsuite-kotlin/src/test/kotlin/docs/tbdex/wallet/rfqMetadataKt.snippet.kt'
import createRfqMessageKt from '!!raw-loader!@site/snippets/testsuite-kotlin/src/test/kotlin/docs/tbdex/wallet/createRfqMessageKt.snippet.kt'
import signRfqMessageKt from '!!raw-loader!@site/snippets/testsuite-kotlin/src/test/kotlin/docs/tbdex/wallet/signRfqMessageKt.snippet.kt'
import sendRfqMessageKt from '!!raw-loader!@site/snippets/testsuite-kotlin/src/test/kotlin/docs/tbdex/wallet/sendRfqMessageKt.snippet.kt'

<LanguageSwitcher languages="JavaScript, Kotlin" />

# Sending RFQs

After your customer selects an [Offering](/docs/tbdex/pfi/creating-offerings), the next step is to send a **Request for Quote (RFQ)** to the PFI in order to initiate the transaction.
The Offering provided an estimate, but the Quote will provide a formal offer based on the financial transaction the customer is requesting as well as the payment methods provided.

## Create the RFQ
An RFQ is a structured tbDEX message that specifies the details of the transaction your customer wishes to make.
It includes information about the Offering, payment methods, and any required [verifiable credentials (VCs)](/docs/tbdex/wallet/managing-credentials).

To create the message, call `Rfq.create()` passing metadata and data:

<Shnip
  snippets={[
    { snippetContent: skeletonRfqMessageJS, language: 'JavaScript' },
    { snippetContent: skeletonRfqMessageKt, language: 'Kotlin' },
  ]}
/>

### metadata
The metadata properties identify the DIDs of the sender (your customer) and the recipient (the PFI):

<Shnip
  snippets={[
    { snippetContent: rfqMetadataJS, language: 'JavaScript' },
    { snippetContent: rfqMetadataKt, language: 'Kotlin' },
  ]}
/>

### data
The data properties contain the specifics of the transaction, such as the id of the Offering you're requesting the Quote for, payment methods, and credentials:

* **offeringId** - The unique identifier of the PFI's Offering the customer is interested in
* **payinAmount** - Total amount of payin currency the customer wants to pay in exchange for payout currency
* **payinMethod** - How the customer intends to pay, including the currency and amount. This includes a `paymentDetails` object which should contain the properties defined in the Offering's `requiredPaymentDetails` JSON schema
* **payoutMethod** - How the customer wishes to receive the payout. This includes a `paymentDetails` object which should contain the properties defined in the Offering's `requiredPaymentDetails` JSON schema
* **claims** - The [VCs that satisfy the requirements of the Offer](/docs/tbdex/wallet/managing-credentials#select-credentials-that-satisfy-requirements)

<Shnip
  snippets={[
    { snippetContent: createRfqMessageJS, language: 'JavaScript' },
    { snippetContent: createRfqMessageKt, language: 'Kotlin' },
  ]}
/>


## Sign the RFQ
Signing the RFQ ensures its authenticity. You can do so with the customer's [Portable DID](/docs/web5/build/decentralized-identifiers/how-to-create-did#portable-did):

<Shnip
  snippets={[
    { snippetContent: signRfqMessageJS, language: 'JavaScript' },
    { snippetContent: signRfqMessageKt, language: 'Kotlin' },
  ]}
/>


## Send RFQ to PFI
Use `TbdexHttpClient` to send the RFQ to the PFI, with an optional `replyTo` property containing a valid URI where new messages from the PFI will be sent:

<Shnip
  snippets={[
    { snippetContent: sendRfqMessageJS, language: 'JavaScript' },
    { snippetContent: sendRfqMessageKt, language: 'Kotlin' },
  ]}
/>

:::tip
If `replyTo` is provided, the PFI will send all new messages of the exchange to the supplied URI. 
This URI is scoped to each exchange, allowing you to specify a different URI per exchange if desired. 

If `replyTo` is _not_ present, you will have to poll the PFI to receive new messages within the exchange.
:::

If no error is thrown, the RFQ has been successfully sent to the PFI and an **exchange** has been created.
This exchange serves as a thread of messages between your application and the PFI regarding this transaction.

The next message written to the exchange will be a [Quote](/docs/tbdex/wallet/receive-quote) from the PFI.
