import { Web5 } from '@web5/api';
import { VerifiableCredential } from '@web5/credentials';

const { web5, did: aliceDid } = await Web5.connect({});
const { did: aliceBearerDid } = await web5.agent.identity.get({ didUri: aliceDid });

class Web5QuickstartCompletionCredential {
    constructor(username, completionDate, expertiseLevel) {
        this.username = username;
        this.completionDate = completionDate;
        this.expertiseLevel = expertiseLevel;
    }
}

const vc = await VerifiableCredential.create({
    type: 'Web5QuickstartCompletionCredential',
    issuer: aliceDid,
    subject: aliceDid,
    expirationDate: '2026-09-30T12:34:56Z',
    data: new Web5QuickstartCompletionCredential(
        '@alicesmith123',
        '2024-05-22',
        'Beginner',
    )
});

const signedVc = await vc.sign({ did: aliceBearerDid });

const { record } = await web5.dwn.records.create({
    data: signedVc,
    message: {
        schema: 'Web5QuickstartCompletionCredential',
        dataFormat: 'application/vc+jwt',
    }
});

const readSignedVc = await record.data.text();