import { Web5 } from '@web5/api';
import { VerifiableCredential } from '@web5/credentials';

const { web5, did: aliceDid } = await Web5.connect();

const { did: aliceBearerDid } = await web5.agent.identity.get({ didUri: aliceDid });

const vc = await VerifiableCredential.create({
  type: 'Web5QuickstartCompletionCredential',
  issuer: aliceDid,
  subject: aliceDid,
  expirationDate: '2026-09-30T12:34:56Z',
  data: {
    username: '@alicesmith123',
    completionDate: '2024-05-22',
    expertiseLevel: 'Beginner'
  }
});

const signedVc = await vc.sign({ did: aliceBearerDid });

const { record } = await web5.dwn.records.create({
  data: signedVc,
  message: {
    schema: 'Web5QuickstartCompletionCredential',
    dataFormat: 'application/vc+jwt',
  }
});

const readSignedVc = await record.data.text();

const parsedVc = VerifiableCredential.parseJwt({ vcJwt: readSignedVc });